name: Teste db-math

on:
  workflow_dispatch:
    inputs:
      name:
        description: 'Servidor a testar'
        default: 'db-math.mysql.database.azure.com'
        required: true
        type: string

      query:
        description: 'Query a testar'
        default: 'create.sql'
        required: true
        type: string

jobs:
  greet:
    runs-on: ubuntu-latest
    environment: database-test

    steps:
    - uses: actions/checkout@v4

    - name: Verificar arquivos no reposit√≥rio
      run: ls -l

    - name: Executar query no MySQL
      run: |
        mysql -h ${{ github.event.inputs.name }} \
              -u${{ secrets.USER }} \
              -p${{ secrets.PASS }} \
              --ssl-mode=REQUIRED \
              db-math < ${{ github.event.inputs.query }}
